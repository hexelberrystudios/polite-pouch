var politePouch=function(t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n,"function"!=typeof Object.assign&&(Object.assign=function(t){for(var n=Object(t),r=1;r<arguments.length;r++){var e=arguments[r];if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n});var r=Object.assign;function e(){return(new Date).toISOString()}function i(t){return t.createdAt?t.updatedAt=e():t.createdAt=e(),t._deleted&&(t.deletedAt=t.deletedAt||t.updatedAt),t}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function u(t){return null===t.id.match(/^_design/)}function c(t){return"object"===(void 0===t?"undefined":o(t))?t._id:t}function a(t,n,r){var e=c(n);return r&&e.substr(0,r.length)!==r&&(e=r+e),t.get(e).catch(function(t){var n=void 0;throw 404===t.status?((n=new Error('Object with id "'+e+'" is missing')).name="Not found",n.status=404,n):t})}function s(t,n,r){var e=n.map(c);return r&&(e=e.map(function(t){return t.substr(0,r.length)===r?t:r+t})),t.allDocs({keys:e,include_docs:!0}).then(function(t){var n=t.rows.reduce(function(t,n){return t[n.id]=n.doc,t},{});return e.map(function(t){var r=n[t];if(r)return r;var e=new Error('Object with id "'+t+'" is missing');return e.name="Not found",e.status=404,e})})}function f(t,n){return"object"===(void 0===t?"undefined":o(t))?r(n,t):t(n),n}function d(t,n,e,o){var u=void 0;return"string"!=typeof n||e?a(t,n,o).then(function(t){return e?f(e,t):r(t,n,{_id:t._id,_rev:t._rev})}).then(function(n){return u=n,t.put(i(u))}).then(function(t){return u._rev=t.rev,u}):Promise.reject("Document must be a JSON object")}function l(t,n,e,u){var a=void 0,d=n.map(function(t){var n=c(t);return u&&n.substr(0,u.length)!==u&&(n=u+n),n});return s(t,d,u).then(function(t){return e?t.map(function(t){return t instanceof Error?t:f(e,t)}):t.map(function(t,e){var i=n[e];return t instanceof Error?t:"object"!==(void 0===i?"undefined":o(i))?Promise.reject("Document must be a JSON object"):r(t,i,{_id:t._id,_rev:t._rev})})}).then(function(n){var r=void 0;return(r=(a=n).filter(function(t){return!(t instanceof Error)})).forEach(i),t.bulkDocs(r)}).then(function(t){return t.forEach(function(t){var n=d.indexOf(t.id);a[n]._rev=t.rev}),a})}function v(t,n){var e="string"==typeof n?{_id:n}:n;return t&&f(t,e),r({_deleted:!0},e)}var h={pleaseAdd:function(t,e){return Array.isArray(t)?function(t,e,o){return e=e.map(function(t){return i(t=r({},t))}),o&&e.forEach(function(t){t._id=o+(t._id||n())}),t.bulkDocs(e).then(function(t){return t.map(function(t,n){var r=void 0;return t instanceof Error?409===t.status?((r=new Error('Object with id "'+e[n]._id+'" already exists')).name="Conflict",r.status=409,r):t:(e[n]._id=t.id,e[n]._rev=t.rev,e[n])})})}(this,t,e):function(t,e,u){return"object"!==(void 0===e?"undefined":o(e))?Promise.reject("Document must be a JSON object"):((e=r({},e))._id||(e._id=n()),u&&(e._id=u+e._id),e=i(e),t.put(e).then(function(t){return e._id=t.id,e._rev=t.rev,e}).catch(function(t){var n=void 0;throw 409===t.status?((n=new Error('Object with id "'+e._id+'" already exists')).name="Conflict",n.status=409,n):t}))}(this,t,e)},pleaseClear:function(){return this.destroy()},pleaseFindAll:function(t,n){var r={include_docs:!0};return n&&(r.startkey=n,r.endkey=n+"￿"),this.allDocs(r).then(function(n){var r=n.rows.filter(u).map(function(t){return t.doc});return"function"==typeof t?r.filter(t):r})},pleaseFind:function(t,n){return Array.isArray(t)?s(this,t,n):a(this,t,n)},pleaseRemoveAll:function(t,n){var r=void 0,e={include_docs:!0};return n&&(e.startkey=n,e.endkey=n+"￿"),this.allDocs(e).then(function(n){return r=n.rows.filter(u).map(function(t){return t.doc}),"function"==typeof t&&(r=r.filter(t)),r.map(function(t){return t._deleted=!0,i(t)})}).then(this.bulkDocs.bind(this)).then(function(t){return t.map(function(t,n){return r[n]._rev=t.rev,r[n]})})},pleaseRemove:function(t,n,r){return Array.isArray(t)?l(this,t.map(v.bind(null,n)),null,r):d(this,v(n,t),null,r)},pleaseUpdate:function(t,n,r){return"object"===(void 0===t?"undefined":o(t))||n?Array.isArray(t)?l(this,t,n,r):d(this,t,n,r):Promise.reject(new Error("Must provide change"))}};return t.politePouch=h,t}({},uuid/v5);
